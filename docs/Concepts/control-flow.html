<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Control flow · Doc center 2018</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="Regardless of the simplicity or complexity of a method, you will always use one or more of three types of programming structures. Programming structures control the flow of execution, whether and in what order statements are executed within a method. There are three types of structures:"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Control flow · Doc center 2018"/><meta property="og:type" content="website"/><meta property="og:url" content="https://arnaud4d.github.io/doc/index.html"/><meta property="og:description" content="Regardless of the simplicity or complexity of a method, you will always use one or more of three types of programming structures. Programming structures control the flow of execution, whether and in what order statements are executed within a method. There are three types of structures:"/><meta property="og:image" content="https://arnaud4d.github.io/doc/img/4dlogo.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://arnaud4d.github.io/doc/img/4dlogo.png"/><link rel="shortcut icon" href="/doc/img/favicon.png"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><link rel="stylesheet" href="/doc/css/main.css"/></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/doc/"><img class="logo" src="/doc/img/4DLogo.gif" alt="Doc center 2018"/><h2 class="headerTitleWithLogo">Doc center 2018</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/doc/docs/Concepts/doc1.html" target="_self">Docs</a></li><li class=""><a href="/doc/docs/doc4.html" target="_self">page4</a></li><li class=""><a href="http://doc.4d.com/" target="_self">doc.4d.com</a></li><li class=""><a href="http://kb.4d.com/" target="_self">knowledgebase</a></li><li class=""><a href="/doc/en/help.html" target="_self">Help</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><i>›</i><span>The 4D Language</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">The 4D Language</h3><ul><li class="navListItem"><a class="navItem" href="/doc/docs/Concepts/doc1.html">About the 4D Language</a></li><li class="navListItem"><a class="navItem" href="/doc/docs/Concepts/quick-tour.html">A Quick Tour</a></li><li class="navListItem"><a class="navItem" href="/doc/docs/Concepts/data-types.html">Data types</a></li><li class="navListItem"><a class="navItem" href="/doc/docs/Concepts/variables-arrays.html">Variables and Arrays</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/doc/docs/Concepts/control-flow.html">Control flow</a></li><li class="navListItem"><a class="navItem" href="/doc/docs/Concepts/methods.html">Methods</a></li><li class="navListItem"><a class="navItem" href="/doc/docs/Concepts/parameters.html">Parameters</a></li><li class="navListItem"><a class="navItem" href="/doc/docs/Concepts/error-handling.html">Error handling</a></li><li class="navListItem"><a class="navItem" href="/doc/docs/Concepts/interpreted-compiled.html">Interpreted and Compiled modes</a></li><li class="navListItem"><a class="navItem" href="/doc/docs/Concepts/debugging.html">Debugger, debug logs and Runtime Explorer</a></li><li class="navListItem"><a class="navItem" href="/doc/docs/Concepts/components.html">Components</a></li><li class="navListItem"><a class="navItem" href="/doc/docs/Concepts/plug-ins.html">Plug-ins</a></li><li class="navListItem"><a class="navItem" href="/doc/docs/Concepts/identifiers.html">Identifiers</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Language Reference</h3><ul><li class="navListItem"><a class="navItem" href="/doc/docs/doc3.html">This is document number 3</a></li></ul></div></div></section></div><script>
            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              const headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                if (event.target.tagName === 'A') {
                  document.body.classList.remove('tocActive');
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 class="postHeaderTitle">Control flow</h1></header><article><div><span><p>Regardless of the simplicity or complexity of a method, you will always use one or more of three types of programming structures. Programming structures control the flow of execution, whether and in what order statements are executed within a method. There are three types of structures:</p>
<ul>
<li><strong>Sequential</strong>: a sequential structure is a simple, linear structure. A sequence is a series of statements that 4D executes one after the other, from first to last. A one-line routine, frequently used for object methods, is the simplest case of a sequential structure. For example: <code>[People]lastName:=Uppercase([People]lastName)</code>. The <code>Use...End use</code> and <code>Begin SQL / End SQL</code> keywords delimit sequential structures to be executed.</li>
<li><strong>Branching</strong>: A branching structure allows methods to test a condition and take alternative paths, depending on the result. The condition is a Boolean expression, an expression that evaluates TRUE or FALSE. One branching structure is the <code>If...Else...End if</code> structure, which directs program flow along one of two paths. The other branching structure is the <code>Case of...Else...End case</code> structure, which directs program flow to one of many paths.</li>
<li><strong>Looping</strong>: When writing methods, it is very common to find that you need a sequence of statements to repeat a number of times. To deal with this need, the 4D language provides the following looping structures:
<ul>
<li>While...End while</li>
<li>Repeat...Until</li>
<li>For...End for</li>
<li>For each...End for each<br>
The loops are controlled in two ways: either they loop until a condition is met, or they loop a specified number of times. Each looping structure can be used in either way, but While loops and Repeat loops are more appropriate for repeating until a condition is met, and For loops are more appropriate for looping a specified number of times. For each...End for each allows mixing both ways and is designed to loop within objects and collections.</li>
</ul></li>
</ul>
<p><strong>Note:</strong> 4D allows you to embed programming structures up to a &quot;depth&quot; of 512 levels.</p>
<h2><a class="anchor" aria-hidden="true" id="ifelseend-if"></a><a href="#ifelseend-if" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>If...Else...End if</h2>
<p>The formal syntax of the <code>If...Else...End if</code> control flow structure is:</p>
<pre><code class="hljs"> If(<span class="hljs-name">Boolean_Expression</span>)
    statement(<span class="hljs-name">s</span>)
 Else
    statement(<span class="hljs-name">s</span>)
 End if
</code></pre>
<p>Note that the <code>Else</code> part is optional; you can write:</p>
<pre><code class="hljs"> <span class="hljs-meta">If</span>(<span class="hljs-keyword">Boolean_Expression)
</span>    statement(s)
 <span class="hljs-meta">End</span> <span class="hljs-meta">if</span>
</code></pre>
<p>The <code>If...Else...End if</code> structure lets your method choose between two actions, depending on whether a test (a Boolean expression) is TRUE or FALSE. When the Boolean expression is TRUE, the statements immediately following the test are executed. If the Boolean expression is FALSE, the statements following the Else statement are executed. The <code>Else</code> statement is optional; if you omit Else, execution continues with the first statement (if any) following the <code>End if</code>.</p>
<p>Note that the Boolean expression is always fully evaluated. Consider in particular the following test:</p>
<pre><code class="hljs"> <span class="hljs-keyword">If</span>(MethodA &amp; MethodB)
    ...
 <span class="hljs-keyword">End</span> <span class="hljs-keyword">if</span>
</code></pre>
<p>he expression is TRUE only if both methods are TRUE. However, even if <em>MethodA</em> returns FALSE, 4D will still evaluate <em>MethodB</em>, which is a useless waste of time. In this case, it is more interesting to use a structure like:</p>
<pre><code class="hljs"> <span class="hljs-keyword">If</span>(MethodA)
    <span class="hljs-keyword">If</span>(MethodB)
       ...
    <span class="hljs-keyword">End</span> <span class="hljs-keyword">if</span>
 <span class="hljs-keyword">End</span> <span class="hljs-keyword">if</span>
</code></pre>
<p>The result is similar and <em>MethodB</em> is evaluated only if necessary.</p>
<h4><a class="anchor" aria-hidden="true" id="example"></a><a href="#example" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example</h4>
<pre><code class="hljs">  <span class="hljs-comment">// Ask the user to enter a name</span>
 $<span class="hljs-built_in">Find</span>:=Request(<span class="hljs-built_in">Type</span> a <span class="hljs-built_in">name</span>)
 <span class="hljs-keyword">If</span>(OK=<span class="hljs-number">1</span>)
    QUERY([People];[People]LastName=$<span class="hljs-built_in">Find</span>)
 <span class="hljs-keyword">Else</span>
    ALERT(<span class="hljs-string">"You did not enter a name."</span>)
 End <span class="hljs-keyword">if</span> 
</code></pre>
<p><strong>Tip:</strong> Branching can be performed without statements to be executed in one case or the other. When developing an algorithm or a specialized application, nothing prevents you from writing:</p>
<pre><code class="hljs"> <span class="hljs-meta">If</span>(<span class="hljs-keyword">Boolean_Expression)
</span> <span class="hljs-meta">Else</span>
    statement(s)
 <span class="hljs-meta">End</span> <span class="hljs-meta">if</span>
</code></pre>
<p>or:</p>
<pre><code class="hljs"> <span class="hljs-meta">If</span>(<span class="hljs-keyword">Boolean_Expression)
</span>    statement(s)
 <span class="hljs-meta">Else</span>
 <span class="hljs-meta">End</span> <span class="hljs-meta">if</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="case-ofelseend-case"></a><a href="#case-ofelseend-case" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Case of...Else...End case</h2>
<p>The formal syntax of the <code>Case of...Else...End case</code> control flow structure is:</p>
<pre><code class="hljs"> <span class="hljs-selector-tag">Case</span> <span class="hljs-selector-tag">of</span>
    <span class="hljs-selector-pseudo">:(Boolean_Expression)</span>
       <span class="hljs-selector-tag">statement</span>(s)
    <span class="hljs-selector-pseudo">:(Boolean_Expression)</span>
       <span class="hljs-selector-tag">statement</span>(s)
       .
       .
       .
 
    <span class="hljs-selector-pseudo">:(Boolean_Expression)</span>
       <span class="hljs-selector-tag">statement</span>(s)
    <span class="hljs-selector-tag">Else</span>
       <span class="hljs-selector-tag">statement</span>(s)
 <span class="hljs-selector-tag">End</span> <span class="hljs-selector-tag">case</span>
</code></pre>
<p>Note that the <code>Else</code> part is optional; you can write:</p>
<pre><code class="hljs"> <span class="hljs-selector-tag">Case</span> <span class="hljs-selector-tag">of</span>
    <span class="hljs-selector-pseudo">:(Boolean_Expression)</span>
       <span class="hljs-selector-tag">statement</span>(s)
    <span class="hljs-selector-pseudo">:(Boolean_Expression)</span>
       <span class="hljs-selector-tag">statement</span>(s)
       .
       .
       .
 
    <span class="hljs-selector-pseudo">:(Boolean_Expression)</span>
       <span class="hljs-selector-tag">statement</span>(s)
 <span class="hljs-selector-tag">End</span> <span class="hljs-selector-tag">case</span>
</code></pre>
<p>As with the <code>If...Else...End if</code> structure, the <code>Case of...Else...End case</code> structure also lets your method choose between alternative actions. Unlike the <code>If...Else...End</code> if structure, the <code>Case of...Else...End case</code> structure can test a reasonable unlimited number of Boolean expressions and take action depending on which one is TRUE.</p>
<p>Each Boolean expression is prefaced by a colon (<code>:</code>). This combination of the colon and the Boolean expression is called a case. For example, the following line is a case:</p>
<pre><code class="hljs">:(<span class="hljs-attribute">bValidate</span>=1)
</code></pre>
<p>Only the statements following the first TRUE case (and up to the next case) will be executed. If none of the cases are TRUE, none of the statements will be executed (if no <code>Else</code> part is included).</p>
<p>You can include an Else statement after the last case. If all of the cases are FALSE, the statements following the <code>Else</code> will be executed.</p>
<h4><a class="anchor" aria-hidden="true" id="example-1"></a><a href="#example-1" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example</h4>
<p>This example tests a numeric variable and displays an alert box with a word in it:</p>
<pre><code class="hljs"> <span class="hljs-keyword">Case</span> <span class="hljs-keyword">of</span>
    :(vResult=<span class="hljs-number">1</span>) ` Test <span class="hljs-keyword">if</span> the number <span class="hljs-keyword">is</span> <span class="hljs-number">1</span>
       ALERT(<span class="hljs-string">"One."</span>) ` <span class="hljs-keyword">If</span> it <span class="hljs-keyword">is</span> <span class="hljs-number">1</span>, display an alert
    :(vResult=<span class="hljs-number">2</span>) ` Test <span class="hljs-keyword">if</span> the number <span class="hljs-keyword">is</span> <span class="hljs-number">2</span>
       ALERT(<span class="hljs-string">"Two."</span>) ` <span class="hljs-keyword">If</span> it <span class="hljs-keyword">is</span> <span class="hljs-number">2</span>, display an alert
    :(vResult=<span class="hljs-number">3</span>) ` Test <span class="hljs-keyword">if</span> the number <span class="hljs-keyword">is</span> <span class="hljs-number">3</span>
       ALERT(<span class="hljs-string">"Three."</span>) ` <span class="hljs-keyword">If</span> it <span class="hljs-keyword">is</span> <span class="hljs-number">3</span>, display an alert
    <span class="hljs-keyword">Else</span> ` <span class="hljs-keyword">If</span> it <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-keyword">or</span> <span class="hljs-number">3</span>, display an alert
       ALERT(<span class="hljs-string">"It was not one, two, or three."</span>)
 <span class="hljs-keyword">End</span> <span class="hljs-keyword">case</span>
</code></pre>
<p>For comparison, here is the <code>If...Else...End if</code> version of the same method:</p>
<pre><code class="hljs"> <span class="hljs-keyword">If</span>(vResult=<span class="hljs-number">1</span>) ` Test <span class="hljs-keyword">if</span> the number <span class="hljs-keyword">is</span> <span class="hljs-number">1</span>
    ALERT(<span class="hljs-string">"One."</span>) ` <span class="hljs-keyword">If</span> it <span class="hljs-keyword">is</span> <span class="hljs-number">1</span>, display an alert
 <span class="hljs-keyword">Else</span>
    <span class="hljs-keyword">If</span>(vResult=<span class="hljs-number">2</span>) ` Test <span class="hljs-keyword">if</span> the number <span class="hljs-keyword">is</span> <span class="hljs-number">2</span>
       ALERT(<span class="hljs-string">"Two."</span>) ` <span class="hljs-keyword">If</span> it <span class="hljs-keyword">is</span> <span class="hljs-number">2</span>, display an alert
    <span class="hljs-keyword">Else</span>
       <span class="hljs-keyword">If</span>(vResult=<span class="hljs-number">3</span>) ` Test <span class="hljs-keyword">if</span> the number <span class="hljs-keyword">is</span> <span class="hljs-number">3</span>
          ALERT(<span class="hljs-string">"Three."</span>) ` <span class="hljs-keyword">If</span> it <span class="hljs-keyword">is</span> <span class="hljs-number">3</span>, display an alert
       <span class="hljs-keyword">Else</span> ` <span class="hljs-keyword">If</span> it <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-keyword">or</span> <span class="hljs-number">3</span>, display an alert
          ALERT(<span class="hljs-string">"It was not one, two, or three."</span>)
       <span class="hljs-keyword">End</span> <span class="hljs-keyword">if</span>
    <span class="hljs-keyword">End</span> <span class="hljs-keyword">if</span>
 <span class="hljs-keyword">End</span> <span class="hljs-keyword">if</span>
</code></pre>
<p>Remember that with a <code>Case of...Else...End case</code> structure, only the first TRUE case is executed. Even if two or more cases are TRUE, only the statements following the first TRUE case will be executed.</p>
<p>Consequently, when you want to implement hierarchical tests, you should make sure the condition statements that are lower in the hierarchical scheme appear first in the test sequence. For example, the test for the presence of condition1 covers the test for the presence of condition1&amp;condition2 and should therefore be located last in the test sequence. For example, the following code will never see its last condition detected:</p>
<pre><code class="hljs"> Case <span class="hljs-keyword">of</span>
    :(vResult=<span class="hljs-number">1</span>)
       ... `statement(s)
    :((vResult=<span class="hljs-number">1</span>) &amp; (vCondition#<span class="hljs-number">2</span>)) `this <span class="hljs-keyword">case</span> will never be detected
       ... `statement(s)
 End <span class="hljs-keyword">case</span>
</code></pre>
<p>In the code above, the presence of the second condition is not detected since the test &quot;vResult=1&quot; branches off the code before any further testing. For the code to operate properly, you can write it as follows:</p>
<pre><code class="hljs"> Case <span class="hljs-keyword">of</span>
    :((vResult=<span class="hljs-number">1</span>) &amp; (vCondition#<span class="hljs-number">2</span>)) `this <span class="hljs-keyword">case</span> will be detected first
       ... `statement(s)
    :(vResult=<span class="hljs-number">1</span>)
       ... `statement(s)
 End <span class="hljs-keyword">case</span>
</code></pre>
<p>Also, if you want to implement hierarchical testing, you may consider using hierarchical code.</p>
<p><strong>Tip:</strong> Branching can be performed without statements to be executed in one case or another. When developing an algorithm or a specialized application, nothing prevents you from writing:</p>
<pre><code class="hljs"> <span class="hljs-keyword">Case</span> <span class="hljs-keyword">of</span>
    :(Boolean_Expression)
    :(Boolean_Expression)
      ...
 
    :(Boolean_Expression)
       statement(s)
    <span class="hljs-keyword">Else</span>
       statement(s)
 <span class="hljs-keyword">End</span> <span class="hljs-keyword">case</span>
</code></pre>
<p>or:</p>
<pre><code class="hljs"> <span class="hljs-keyword">Case</span> <span class="hljs-keyword">of</span>
    :(Boolean_Expression)
    :(Boolean_Expression)
       statement(s)
       ...
        
    :(Boolean_Expression)
       statement(s)
    <span class="hljs-keyword">Else</span>
 <span class="hljs-keyword">End</span> <span class="hljs-keyword">case</span>
</code></pre>
<p>or:</p>
<pre><code class="hljs"> <span class="hljs-keyword">Case</span> <span class="hljs-keyword">of</span>
    <span class="hljs-keyword">Else</span>
       statement(s)
 <span class="hljs-keyword">End</span> <span class="hljs-keyword">case</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="whileend-while"></a><a href="#whileend-while" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>While...End while</h2>
<p>The formal syntax of the <code>While...End while</code> control flow structure is:</p>
<pre><code class="hljs"> <span class="hljs-meta">While</span>(<span class="hljs-keyword">Boolean_Expression)
</span>    statement(s)
 <span class="hljs-meta">End</span> <span class="hljs-meta">while</span>
</code></pre>
<p>A <code>While...End while</code> loop executes the statements inside the loop as long as the Boolean expression is TRUE. It tests the Boolean expression at the beginning of the loop and does not enter the loop at all if the expression is FALSE.</p>
<p>It is common to initialize the value tested in the Boolean expression immediately before entering the <code>While...End while</code> loop. Initializing the value means setting it to something appropriate, usually so that the Boolean expression will be TRUE and <code>While...End while</code> executes the loop.</p>
<p>The Boolean expression must be set by something inside the loop or else the loop will continue forever. The following loop continues forever because <em>NeverStop</em> is always TRUE:</p>
<pre><code class="hljs"> NeverStop:=<span class="hljs-literal">True</span>
 <span class="hljs-keyword">While</span>(NeverStop)
 <span class="hljs-keyword">End</span> <span class="hljs-keyword">while</span>
</code></pre>
<p>If you find yourself in such a situation, where a method is executing uncontrolled, you can use the trace facilities to stop the loop and track down the problem. For more information about tracing a method, see the <a href="debug.md">Debugging</a> page.</p>
<h4><a class="anchor" aria-hidden="true" id="example-2"></a><a href="#example-2" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example</h4>
<pre><code class="hljs"> CONFIRM(<span class="hljs-string">"Add a new record?"</span>) ` The<span class="hljs-built_in"> user </span>wants <span class="hljs-keyword">to</span> <span class="hljs-builtin-name">add</span> a record?
 <span class="hljs-keyword">While</span>(<span class="hljs-attribute">OK</span>=1) ` Loop as long as the<span class="hljs-built_in"> user </span>wants <span class="hljs-keyword">to</span>
    <span class="hljs-builtin-name">ADD</span> RECORD([aTable]) ` <span class="hljs-builtin-name">Add</span> a new record
 End <span class="hljs-keyword">while</span> ` The loop always ends with End <span class="hljs-keyword">while</span>
</code></pre>
<p>In this example, the <code>OK</code> system variable is set by the <code>CONFIRM</code> command before the loop starts. If the user clicks the <strong>OK</strong> button in the confirmation dialog box, the <code>OK</code> system variable is set to 1 and the loop starts. Otherwise, the <code>OK</code> system variable is set to 0 and the loop is skipped. Once the loop starts, the <code>ADD RECORD</code> command keeps the loop going because it sets the <code>OK</code> system variable to 1 when the user saves the record. When the user cancels (does not save) the last record, the <code>OK</code> system variable is set to 0 and the loop stops.</p>
<h2><a class="anchor" aria-hidden="true" id="repeatuntil"></a><a href="#repeatuntil" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Repeat...Until</h2>
<p>The formal syntax of the <code>Repeat...Until</code> control flow structure is:</p>
<pre><code class="hljs"> Repeat
    statement(<span class="hljs-name">s</span>)
 Until(<span class="hljs-name">Boolean_Expression</span>)
</code></pre>
<p>A <code>Repeat...Until</code> loop is similar to a <a href="flow-control#whileend-while">While...End while</a> loop, except that it tests the Boolean expression after the loop rather than before. Thus, a <code>Repeat...Until</code> loop always executes the loop once, whereas if the Boolean expression is initially False, a <code>While...End while</code> loop does not execute the loop at all.</p>
<p>The other difference with a <code>Repeat...Until</code> loop is that the loop continues until the Boolean expression is TRUE.</p>
<h4><a class="anchor" aria-hidden="true" id="example-3"></a><a href="#example-3" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example</h4>
<p>Compare the following example with the example for the <code>While...End while</code> loop. Note that the Boolean expression does not need to be initialized—there is no <code>CONFIRM</code> command to initialize the <code>OK</code> variable.</p>
<pre><code class="hljs"> <span class="hljs-keyword">Repeat</span>
    <span class="hljs-keyword">ADD</span> <span class="hljs-keyword">RECORD</span>([aTable])
 <span class="hljs-keyword">Until</span>(OK=<span class="hljs-number">0</span>)
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="forend-for"></a><a href="#forend-for" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>For...End for</h2>
<p>The formal syntax of the <code>For...End for</code> control flow structure is:</p>
<pre><code class="hljs"> <span class="hljs-keyword">For</span>(Counter_Variable;Start_Expression;End_Expression{;Increment_Expression})
    statement(s)
 <span class="hljs-keyword">End</span> <span class="hljs-keyword">for</span>
</code></pre>
<p>The <code>For...End for</code> loop is a loop controlled by a counter variable:</p>
<ul>
<li>The counter variable <em>Counter_Variable</em> is a numeric variable (Real or Long Integer) that the <code>For...End for</code> loop initializes to the value specified by <em>Start_Expression</em>.</li>
<li>Each time the loop is executed, the counter variable is incremented by the value specified in the optional value <em>Increment_Expression</em>. If you do not specify <em>Increment_Expression</em>, the counter variable is incremented by one (1), which is the default.</li>
<li>When the counter variable passes the <em>End_Expression</em> value, the loop stops.</li>
</ul>
<p><strong>Important:</strong> The numeric expressions <em>Start_Expression</em>, <em>End_Expression</em> and <em>Increment_Expression</em> are evaluated once at the beginning of the loop. If these expressions are variables, changing one of these variables within the loop will not affect the loop.</p>
<p><strong>Tip:</strong> However, for special purposes, you can change the value of the counter variable <em>Counter_Variable</em> within the loop; this will affect the loop.</p>
<ul>
<li>Usually <em>Start_Expression</em> is less than <em>End_Expression</em>.</li>
<li>If <em>Start_Expression</em> and <em>End_Expression</em> are equal, the loop will execute only once.</li>
<li>If <em>Start_Expression</em> is greater than <em>End_Expression</em>, the loop will not execute at all unless you specify a negative <em>Increment_Expression</em>. See the examples.</li>
</ul>
<h4><a class="anchor" aria-hidden="true" id="basic-examples"></a><a href="#basic-examples" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Basic examples</h4>
<ol>
<li>The following example executes 100 iterations:</li>
</ol>
<pre><code class="hljs"> <span class="hljs-keyword">For</span>(vCounter;<span class="hljs-number">1</span>;<span class="hljs-number">100</span>)
  ` <span class="hljs-keyword">Do</span> something
 <span class="hljs-keyword">End</span> <span class="hljs-keyword">for</span>
</code></pre>
<ol start="2">
<li>The following example goes through all elements of the array anArray:</li>
</ol>
<pre><code class="hljs"> <span class="hljs-keyword">For</span>($vlElem;<span class="hljs-number">1</span>;Size <span class="hljs-keyword">of</span> <span class="hljs-keyword">array</span>(anArray))
  ` <span class="hljs-keyword">Do</span> something <span class="hljs-keyword">with</span> the element
    anArray{$vlElem}:=...
 <span class="hljs-keyword">End</span> <span class="hljs-keyword">for</span>
</code></pre>
<ol start="3">
<li>The following example goes through all the characters of the text vtSomeText:</li>
</ol>
<pre><code class="hljs"> <span class="hljs-keyword">For</span>($vlChar;<span class="hljs-number">1</span>;Length(vtSomeText))
  ` <span class="hljs-keyword">Do</span> something with the character <span class="hljs-keyword">if</span> it is a <span class="hljs-built_in">TAB</span>
    <span class="hljs-keyword">If</span>(Character <span class="hljs-built_in">code</span>(vtSomeText[[$vlChar]])=<span class="hljs-built_in">Tab</span>)
  ` ...
    <span class="hljs-keyword">End</span> <span class="hljs-keyword">if</span>
 <span class="hljs-keyword">End</span> <span class="hljs-keyword">for</span>
</code></pre>
<ol start="4">
<li>The following example goes through the selected records for the table [aTable]:</li>
</ol>
<pre><code class="hljs"> FIRST RECORD([aTable])
 For($vlRecord;1;Records in selection([aTable]))
  ` <span class="hljs-keyword">Do</span> something <span class="hljs-keyword">with</span> the <span class="hljs-built_in">record</span>
    SEND <span class="hljs-built_in">RECORD</span>([aTable])
  <span class="hljs-string">` ...
  `</span> <span class="hljs-keyword">Go</span> <span class="hljs-keyword">to</span> the <span class="hljs-keyword">next</span> <span class="hljs-built_in">record</span>
    <span class="hljs-keyword">NEXT</span> <span class="hljs-built_in">RECORD</span>([aTable])
 <span class="hljs-keyword">End</span> <span class="hljs-keyword">for</span>
</code></pre>
<p>Most of the <code>For...End for</code> loops you will write in your databases will look like the ones listed in these examples.</p>
<h4><a class="anchor" aria-hidden="true" id="decrementing-variable-counter"></a><a href="#decrementing-variable-counter" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Decrementing variable counter</h4>
<p>In some cases, you may want to have a loop whose counter variable is decreasing rather than increasing. To do so, you must specify <em>Start_Expression</em> greater than <em>End_Expression</em> and a negative <em>Increment_Expression</em>. The following examples do the same thing as the previous examples, but in reverse order:</p>
<ol start="5">
<li>The following example executes 100 iterations:</li>
</ol>
<pre><code class="hljs"> <span class="hljs-keyword">For</span>(vCounter;<span class="hljs-number">100</span>;<span class="hljs-number">1</span>;-<span class="hljs-number">1</span>)
  ` <span class="hljs-keyword">Do</span> something
 <span class="hljs-keyword">End</span> <span class="hljs-keyword">for</span>
</code></pre>
<ol start="6">
<li>The following example goes through all elements of the array anArray:</li>
</ol>
<pre><code class="hljs"> <span class="hljs-keyword">For</span>($vlElem;Size <span class="hljs-keyword">of</span> <span class="hljs-keyword">array</span>(anArray);<span class="hljs-number">1</span>;-<span class="hljs-number">1</span>)
  ` <span class="hljs-keyword">Do</span> something <span class="hljs-keyword">with</span> the element
    anArray{$vlElem}:=...
 <span class="hljs-keyword">End</span> <span class="hljs-keyword">for</span>
</code></pre>
<ol start="7">
<li>The following example goes through all the characters of the text vtSomeText:</li>
</ol>
<pre><code class="hljs"> <span class="hljs-keyword">For</span>($vlChar;Length(vtSomeText);<span class="hljs-number">1</span>;<span class="hljs-number">-1</span>)
  ` <span class="hljs-keyword">Do</span> something with the character <span class="hljs-keyword">if</span> it is a <span class="hljs-built_in">TAB</span>
    <span class="hljs-keyword">If</span>(Character <span class="hljs-built_in">code</span>(vtSomeText[[$vlChar]])=<span class="hljs-built_in">Tab</span>)
  ` ...
    <span class="hljs-keyword">End</span> <span class="hljs-keyword">if</span>
 <span class="hljs-keyword">End</span> <span class="hljs-keyword">for</span>
</code></pre>
<ol start="8">
<li>The following example goes through the selected records for the table [aTable]:</li>
</ol>
<pre><code class="hljs"> LAST <span class="hljs-keyword">RECORD</span>([aTable])
 <span class="hljs-keyword">For</span>($vlRecord;Records <span class="hljs-keyword">in</span> selection([aTable]);<span class="hljs-number">1</span>;-<span class="hljs-number">1</span>)
  ` <span class="hljs-keyword">Do</span> something <span class="hljs-keyword">with</span> the <span class="hljs-keyword">record</span>
    SEND <span class="hljs-keyword">RECORD</span>([aTable])
  ` ...
  ` Go to the previous <span class="hljs-keyword">record</span>
    PREVIOUS <span class="hljs-keyword">RECORD</span>([aTable])
 <span class="hljs-keyword">End</span> <span class="hljs-keyword">for</span>
</code></pre>
<h4><a class="anchor" aria-hidden="true" id="incrementing-the-counter-variable-by-more-than-one"></a><a href="#incrementing-the-counter-variable-by-more-than-one" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Incrementing the counter variable by more than one</h4>
<p>If you need to, you can use an <em>Increment_Expression</em> (positive or negative) whose absolute value is greater than one.</p>
<ol start="9">
<li>The following loop addresses only the even elements of the array anArray:</li>
</ol>
<pre><code class="hljs"> <span class="hljs-keyword">For</span>($vlElem;<span class="hljs-number">2</span>;Size <span class="hljs-keyword">of</span> array(anArray);<span class="hljs-number">2</span>)
  ` <span class="hljs-keyword">Do</span> something <span class="hljs-keyword">with</span> the element <span class="hljs-string">#2</span>,<span class="hljs-string">#4</span>...<span class="hljs-string">#2</span>n
    anArray{$vlElem}:=...
 <span class="hljs-keyword">End</span> <span class="hljs-keyword">for</span>
</code></pre>
<h4><a class="anchor" aria-hidden="true" id="getting-out-of-a-loop-by-changing-the-counter-variable"></a><a href="#getting-out-of-a-loop-by-changing-the-counter-variable" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Getting out of a loop by changing the counter variable</h4>
<p>In some cases, you may want to execute a loop for a specific number of iterations, but then get out of the loop when another condition becomes TRUE. To do so, you can test this condition within the loop and if it becomes TRUE, explicitly set the counter variable to a value that exceeds the end expression.</p>
<ol start="10">
<li>In the following example, a selection of the records is browsed until this is actually done or until the interprocess variable <em>&lt;&gt;vbWeStop</em>, intially set to FALSE, becomes TRUE. This variable is handled by an <code>ON EVENT CALL</code> project method that allows you to interrupt the operation:</li>
</ol>
<pre><code class="hljs"> &lt;&gt;vbWeStop:=<span class="hljs-literal">False</span>
 <span class="hljs-keyword">ON</span> EVENT CALL(<span class="hljs-string">"HANDLE STOP"</span>)
  ` HANDLE STOP sets &lt;&gt;vbWeStop <span class="hljs-keyword">to</span> <span class="hljs-literal">True</span> <span class="hljs-keyword">if</span> Ctrl-period (Windows) <span class="hljs-keyword">or</span> Cmd-Period (Macintosh) <span class="hljs-keyword">is</span> pressed
 $vlNbRecords:=Records <span class="hljs-keyword">in</span> selection([aTable])
 FIRST <span class="hljs-keyword">RECORD</span>([aTable])
 <span class="hljs-keyword">For</span>($vlRecord;<span class="hljs-number">1</span>;$vlNbRecords)
  ` Do something <span class="hljs-keyword">with</span> the <span class="hljs-keyword">record</span>
    SEND <span class="hljs-keyword">RECORD</span>([aTable])
  ` ...
  ` Go <span class="hljs-keyword">to</span> the <span class="hljs-keyword">next</span> <span class="hljs-keyword">record</span>
    <span class="hljs-keyword">If</span>(&lt;&gt;vbWeStop)
       $vlRecord:=$vlNbRecords+<span class="hljs-number">1</span> ` <span class="hljs-keyword">Force</span> the counter <span class="hljs-keyword">variable</span> <span class="hljs-keyword">to</span> get <span class="hljs-keyword">out</span> <span class="hljs-keyword">of</span> the <span class="hljs-keyword">loop</span>
    <span class="hljs-keyword">Else</span>
       <span class="hljs-keyword">NEXT</span> <span class="hljs-keyword">RECORD</span>([aTable])
    <span class="hljs-keyword">End</span> <span class="hljs-keyword">if</span>
 <span class="hljs-keyword">End</span> <span class="hljs-keyword">for</span>
 <span class="hljs-keyword">ON</span> EVENT CALL(<span class="hljs-string">""</span>)
 <span class="hljs-keyword">If</span>(&lt;&gt;vbWeStop)
    ALERT(<span class="hljs-string">"The operation has been interrupted."</span>)
 <span class="hljs-keyword">Else</span>
    ALERT(<span class="hljs-string">"The operation has been successfully completed."</span>)
 <span class="hljs-keyword">End</span> <span class="hljs-keyword">if</span>
</code></pre>
<h4><a class="anchor" aria-hidden="true" id="comparing-looping-structures"></a><a href="#comparing-looping-structures" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Comparing looping structures</h4>
<p>Let's go back to the first <code>For...End for</code> example. The following example executes 100 iterations:</p>
<pre><code class="hljs"> <span class="hljs-keyword">For</span>(vCounter;<span class="hljs-number">1</span>;<span class="hljs-number">100</span>)
  ` <span class="hljs-keyword">Do</span> something
 <span class="hljs-keyword">End</span> <span class="hljs-keyword">for</span>
</code></pre>
<p>It is interesting to see how the <code>While...End while</code> loop and <code>Repeat...Until</code> loop would perform the same action. Here is the equivalent <code>While...End while</code> loop:</p>
<pre><code class="hljs"> $i :=<span class="hljs-number">1</span> ` Initialize the counter
 <span class="hljs-keyword">While</span>($i&lt;=<span class="hljs-number">100</span>) ` Loop <span class="hljs-number">100</span> times
  ` <span class="hljs-keyword">Do</span> something
    $i :=$i +<span class="hljs-number">1</span> ` Need <span class="hljs-keyword">to</span> increment the counter
 End <span class="hljs-keyword">while</span>
</code></pre>
<p>Here is the equivalent <code>Repeat...Until</code> loop:</p>
<pre><code class="hljs"> $i :=<span class="hljs-number">1</span> ` Initialize the counter
 Repeat
  ` <span class="hljs-keyword">Do</span> something
    $i :=$i +<span class="hljs-number">1</span> ` Need <span class="hljs-keyword">to</span> increment the counter
 <span class="hljs-keyword">Until</span>($i=<span class="hljs-number">100</span>) ` Loop <span class="hljs-number">100</span> times
</code></pre>
<p><strong>Tip:</strong> The <code>For...End for</code> loop is usually faster than the <code>While...End while</code> and <code>Repeat...Until</code> loops, because 4D tests the condition internally for each cycle of the loop and increments the counter. Therefore, use the <code>For...End for</code> loop whenever possible.</p>
<h4><a class="anchor" aria-hidden="true" id="optimizing-the-execution-of-the-forend-for-loops"></a><a href="#optimizing-the-execution-of-the-forend-for-loops" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Optimizing the execution of the For...End for loops</h4>
<p>You can use Real and Long Integer variables as well as interprocess, process, and local variable counters. For lengthy repetitive loops, especially in compiled mode, use local Long Integer variables.</p>
<ol start="11">
<li>Here is an example:</li>
</ol>
<pre><code class="hljs"> C_LONGINT($vlCounter) ` <span class="hljs-keyword">use</span> <span class="hljs-keyword">local</span> <span class="hljs-keyword">Long</span> <span class="hljs-built_in">Integer</span> <span class="hljs-keyword">variables</span>
 <span class="hljs-keyword">For</span>($vlCounter;1;10000)
  ` <span class="hljs-keyword">Do</span> something
 <span class="hljs-keyword">End</span> <span class="hljs-keyword">for</span>
</code></pre>
<h4><a class="anchor" aria-hidden="true" id="nested-forend-for-looping-structures"></a><a href="#nested-forend-for-looping-structures" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Nested For...End for looping structures</h4>
<p>You can nest as many control structures as you (reasonably) need. This includes nesting <code>For...End for</code> loops. To avoid mistakes, make sure to use different counter variables for each looping structure.</p>
<p>Here are two examples:</p>
<ol start="12">
<li>The following example goes through all the elements of a two-dimensional array:</li>
</ol>
<pre><code class="hljs"> For($vlElem;<span class="hljs-number">1</span>;Size <span class="hljs-keyword">of</span> <span class="hljs-keyword">array</span>(anArray))
  ` ...
  ` Do something with the row
  ` ...
    For($vlSubElem;<span class="hljs-number">1</span>;Size <span class="hljs-keyword">of</span> <span class="hljs-keyword">array</span>(anArray{$vlElem}))
  ` Do something with the <span class="hljs-literal">element</span>
       anArray{$vlElem}{$vlSubElem}:=...
    End <span class="hljs-keyword">for</span>
 End <span class="hljs-keyword">for</span>
</code></pre>
<ol start="13">
<li>The following example builds an array of pointers to all the date fields present in the database:</li>
</ol>
<pre><code class="hljs"> ARRAY POINTER(<span class="hljs-variable">$apDateFields</span>;<span class="hljs-number">0</span>)
 <span class="hljs-variable">$vlElem:</span>=<span class="hljs-number">0</span>
 <span class="hljs-keyword">For</span>(<span class="hljs-variable">$vlTable</span>;<span class="hljs-number">1</span>;Get last table number)
    <span class="hljs-keyword">If</span>(Is table number valid(<span class="hljs-variable">$vlTable</span>))
       <span class="hljs-keyword">For</span>(<span class="hljs-variable">$vlField</span>;<span class="hljs-number">1</span>;Get last field number(<span class="hljs-variable">$vlTable</span>))
          <span class="hljs-keyword">If</span>(Is field number valid(<span class="hljs-variable">$vlTable</span>;<span class="hljs-variable">$vlField</span>))
             <span class="hljs-variable">$vpField:</span>=Field(<span class="hljs-variable">$vlTable</span>;<span class="hljs-variable">$vlField</span>)
             <span class="hljs-keyword">If</span>(Type(<span class="hljs-variable">$vpField</span>-&gt;)=Is date)
                <span class="hljs-variable">$vlElem:</span>=<span class="hljs-variable">$vlElem</span>+<span class="hljs-number">1</span>
                INSERT <span class="hljs-keyword">IN</span> ARRAY(<span class="hljs-variable">$apDateFields</span>;<span class="hljs-variable">$vlElem</span>)
                <span class="hljs-variable">$apDateFields</span>{<span class="hljs-variable">$vlElem</span>}:=<span class="hljs-variable">$vpField</span>
             <span class="hljs-keyword">End</span> <span class="hljs-keyword">if</span>
          <span class="hljs-keyword">End</span> <span class="hljs-keyword">if</span>
       <span class="hljs-keyword">End</span> <span class="hljs-keyword">for</span>
    <span class="hljs-keyword">End</span> <span class="hljs-keyword">if</span>
 <span class="hljs-keyword">End</span> <span class="hljs-keyword">for</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="for-eachend-for-each"></a><a href="#for-eachend-for-each" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>For each...End for each</h2>
<p>The formal syntax of the <code>For each...End for each</code> control flow structure is:</p>
<pre><code class="hljs"> <span class="hljs-keyword">For</span> each(Current_Item;Expression{;<span class="hljs-keyword">begin</span>{;<span class="hljs-keyword">end</span>}}){<span class="hljs-keyword">Until</span>|<span class="hljs-keyword">While</span>}(Boolean_Expression)}
    statement(s)
 <span class="hljs-keyword">End</span> <span class="hljs-keyword">for</span> each
</code></pre>
<p>The <code>For each...End for each</code> structure iterates a specified <em>Current_item</em> over all values of the <em>Expression</em>. The <em>Current_item</em> type depends on the <em>Expression</em> type. The <code>For each...End for each</code> loop can iterate through three <em>Expression</em> types:</p>
<ul>
<li>collections: loop through each element of the collection,</li>
<li>entity selections: loop through each entity,</li>
<li>objects: loop through each object property.</li>
</ul>
<p>The following table compares the three types of <code>For each...End for each</code>:</p>
<table>
<thead>
<tr><th></th><th>Loop through collections</th><th>Loop through entity selections</th><th>Loop through objects</th></tr>
</thead>
<tbody>
<tr><td>Current_Item type</td><td>Variable of the same type as collection elements</td><td>Entity</td><td>Text variable</td></tr>
<tr><td>Expression type</td><td>Collection (with elements of the same type)</td><td>Entity selection</td><td>Object</td></tr>
<tr><td>Number of loops (by default)</td><td>Number of collection elements</td><td>Number of entities in the selection</td><td>Number of object properties</td></tr>
<tr><td>Support of begin / end parameters</td><td>Yes</td><td>Yes</td><td>No</td></tr>
</tbody>
</table>
<ul>
<li>The number of loops is evaluated at startup and will not change during the processing. Adding or removing items during the loop is usually not recommended since it may result in missing or redundant iterations.</li>
<li>By default, the enclosed <em>statement(s)</em> are executed for each value in <em>Expression</em>. It is, however, possible to exit the loop by testing a condition either at the begining of the loop (<code>While</code>) or at the end of the loop (<code>Until</code>).</li>
<li>The <em>begin</em> and <em>end</em> optional parameters can be used with collections and entity selections to define boundaries for the loop.</li>
<li>The <code>For each...End for each</code> loop can be used on a <strong>shared collection</strong> or a <strong>shared object</strong>. If your code needs to modify one or more element(s) of the collection or object properties, you need to use the <code>Use...End use</code> keywords. Depending on your needs, you can call the <code>Use...End use</code> keywords:
<ul>
<li>before entering the loop, if items should be modified together for integrity reasons, or</li>
<li>within the loop when only some elements/properties need to be modified and no integrity management is required.</li>
</ul></li>
</ul>
<h3><a class="anchor" aria-hidden="true" id="loop-through-collections"></a><a href="#loop-through-collections" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Loop through collections</h3>
<p>When <code>For each...End for each</code> is used with an <em>Expression</em> of the <em>Collection</em> type, the <em>Current_Item</em> parameter is a variable of the same type as the collection elements. By default, the number of loops is based on the number of items of the collection.</p>
<p>The collection must contain only elements of the same type, otherwise an error will be returned as soon as the <em>Current_Item</em> variable is assigned the first mismatched value type.</p>
<p>At each loop iteration, the <em>Current_Item</em> variable is automatically filled with the matching element of the collection. The following points must be taken into account:</p>
<ul>
<li>If the <em>Current_Item</em> variable is of the object type or collection type (i.e. if <em>Expression</em> is a collection of objects or of collections), modifying this variable will automatically modify the matching element of the collection (because objects and collections share the same references). If the variable is of a scalar type, only the variable will be modified.</li>
<li>The <em>Current_Item</em> variable must be of the same type as the collection elements. If any collection item is not of the same type as the variable, an error is generated and the loop stops.</li>
<li>If the collection contains elements with a <strong>Null</strong> value, an error will be generated if the <em>Current_Item</em> variable type does not support <strong>Null</strong> values (such as longint variables).</li>
</ul>
<h4><a class="anchor" aria-hidden="true" id="example-4"></a><a href="#example-4" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example</h4>
<p>You want to compute some statistics for a collection of numbers:</p>
<pre><code class="hljs"> C_COLLECTION(<span class="hljs-variable">$nums</span>)
 <span class="hljs-variable">$nums:</span>=New collection(<span class="hljs-number">10</span>;<span class="hljs-number">5001</span>;<span class="hljs-number">6665</span>;<span class="hljs-number">33</span>;<span class="hljs-number">1</span>;<span class="hljs-number">42</span>;<span class="hljs-number">7850</span>)
 C_LONGINT(<span class="hljs-variable">$item</span>;<span class="hljs-variable">$vEven</span>;<span class="hljs-variable">$vOdd</span>;<span class="hljs-variable">$vUnder</span>;<span class="hljs-variable">$vOver</span>)
 <span class="hljs-keyword">For</span> each(<span class="hljs-variable">$item</span>;<span class="hljs-variable">$nums</span>)
    <span class="hljs-keyword">If</span>(<span class="hljs-variable">$item</span>%<span class="hljs-number">2</span>=<span class="hljs-number">0</span>)
       <span class="hljs-variable">$vEven:</span>=<span class="hljs-variable">$vEven</span>+<span class="hljs-number">1</span>
    <span class="hljs-keyword">Else</span>
       <span class="hljs-variable">$vOdd:</span>=<span class="hljs-variable">$vOdd</span>+<span class="hljs-number">1</span>
    <span class="hljs-keyword">End</span> <span class="hljs-keyword">if</span>
    Case of
       :(<span class="hljs-variable">$item</span>&lt;<span class="hljs-number">5000</span>)
          <span class="hljs-variable">$vUnder:</span>=<span class="hljs-variable">$vUnder</span>+<span class="hljs-number">1</span>
       :(<span class="hljs-variable">$item</span>&gt;<span class="hljs-number">6000</span>)
          <span class="hljs-variable">$vOver:</span>=<span class="hljs-variable">$vOver</span>+<span class="hljs-number">1</span>
    <span class="hljs-keyword">End</span> case
 <span class="hljs-keyword">End</span> <span class="hljs-keyword">for</span> each
  //<span class="hljs-variable">$vEven</span>=<span class="hljs-number">3</span>, <span class="hljs-variable">$vOdd</span>=<span class="hljs-number">4</span>
  //<span class="hljs-variable">$vUnder</span>=<span class="hljs-number">4</span>,<span class="hljs-variable">$vOver</span>=<span class="hljs-number">2</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="loop-through-entity-selections"></a><a href="#loop-through-entity-selections" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Loop through entity selections</h3>
<p>When <code>For each...End for each</code> is used with an <em>Expression</em> of the <em>Entity selection</em> type, the <em>Current_Item</em> parameter is the entity that is currently processed.</p>
<p>The number of loops is based on the number of entities in the entity selection. On each loop iteration, the <em>Current_Item</em> parameter is automatically filled with the entity of the entity selection that is currently processed.</p>
<p><strong>Note:</strong> If the entity selection contains an entity that was removed meanwhile by another process, it is automatically skipped during the loop.</p>
<p>Keep in mind that any modifications applied on the current entity must be saved explicitly using <code>entity.save( )</code>.</p>
<h4><a class="anchor" aria-hidden="true" id="example-5"></a><a href="#example-5" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example</h4>
<p>You want to raise the salary of all British employees in an entity selection:</p>
<pre><code class="hljs"> C_OBJECT(emp)
 <span class="hljs-keyword">For</span> each(emp;<span class="hljs-keyword">ds</span>.Employees.<span class="hljs-keyword">query</span>(<span class="hljs-string">"country='UK'"</span>))
    emp.salary:=emp.salary*1,03
    emp.<span class="hljs-keyword">save</span>()
 End <span class="hljs-keyword">for</span> each
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="loop-through-object-properties"></a><a href="#loop-through-object-properties" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Loop through object properties</h3>
<p>When <code>For each...End for each</code> is used with an <em>Expression</em> of the Object type, the <em>Current_Item</em> parameter is a text variable automatically filled with the name of the currently processed property.</p>
<p>The properties of the object are processed according to their order of creation. During the loop, properties can be added to or removed from the object, without modifying the number of loops that will remain based on the original number of properties of the object.</p>
<h4><a class="anchor" aria-hidden="true" id="example-6"></a><a href="#example-6" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example</h4>
<p>You want to switch the names to uppercase in the following object:</p>
<pre><code class="hljs">{
    <span class="hljs-attr">"firstname"</span>: <span class="hljs-string">"gregory"</span>,
    <span class="hljs-attr">"lastname"</span>: <span class="hljs-string">"badikora"</span>,
    <span class="hljs-attr">"age"</span>: <span class="hljs-number">20</span>
}
</code></pre>
<p>You can write:</p>
<pre><code class="hljs"> <span class="hljs-keyword">For</span> <span class="hljs-keyword">each</span>(<span class="hljs-keyword">property</span>;vObject)
    <span class="hljs-keyword">If</span>(Value <span class="hljs-keyword">type</span>(vObject[<span class="hljs-keyword">property</span>])=<span class="hljs-keyword">Is</span> text)
       vObject[<span class="hljs-keyword">property</span>]:=Uppercase(vObject[<span class="hljs-keyword">property</span>])
    <span class="hljs-keyword">End</span> <span class="hljs-keyword">if</span>
 <span class="hljs-keyword">End</span> <span class="hljs-keyword">for</span> <span class="hljs-keyword">each</span>
</code></pre>
<pre><code class="hljs">{
    <span class="hljs-attr">"firstname"</span>: <span class="hljs-string">"GREGORY"</span>,
    <span class="hljs-attr">"lastname"</span>: <span class="hljs-string">"BADIKORA"</span>,
    <span class="hljs-attr">"age"</span>: <span class="hljs-number">20</span>
}
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="begin-end-parameters"></a><a href="#begin-end-parameters" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>begin / end parameters</h3>
<p>You can define bounds to the iteration using the optional begin and end parameters.</p>
<p><strong>Note:</strong> The <em>begin</em> and <em>end</em> parameters can only be used in iterations through collections and entity selections (they are ignored on object properties).</p>
<ul>
<li>In the <em>begin</em> parameter, pass the element position in <em>Expression</em> at which to start the iteration (<em>begin</em> is included).</li>
<li>In the <em>end</em> parameter, you can also pass the element position in <em>Expression</em> at which to stop the iteration (<em>end</em> is excluded).</li>
</ul>
<p>If <em>end</em> is omitted or if <em>end</em> is greater than the number of elements in <em>Expression</em>, elements are iterated from <em>begin</em> until the last one (included).
If the <em>begin</em> and <em>end</em> parameters are positive values, they represent actual positions of elements in <em>Expression</em>.
If <em>begin</em> is a negative value, it is recalculed as <code>begin:=begin+Expression size</code> (it is considered as the offset from the end of <em>Expression</em>). If the calculated value is negative, <em>begin</em> is set to 0.
<strong>Note:</strong> Even if begin is negative, the iteration is still performed in the standard order.
If <em>end</em> is a negative value, it is recalculed as <code>end:=end+Expression size</code></p>
<p>For example:</p>
<ul>
<li>a collection contains 10 elements (numbered from 0 to 9)</li>
<li>begin=-4 -&gt; begin=-4+10=6 -&gt; iteration starts at the 6th element (#5)</li>
<li>end=-2 -&gt; end=-2+10=8 -&gt; iteration stops before the 8th element (#7), i.e. at the 7th element.</li>
</ul>
<h4><a class="anchor" aria-hidden="true" id="example-7"></a><a href="#example-7" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example</h4>
<pre><code class="hljs"> C_COLLECTION($col;$col2)
 $col:=New collection(<span class="hljs-string">"a"</span>;<span class="hljs-string">"b"</span>;<span class="hljs-string">"c"</span>;<span class="hljs-string">"d"</span>;<span class="hljs-string">"e"</span>)
 $col2:=New collection(<span class="hljs-number">1</span>;<span class="hljs-number">2</span>;<span class="hljs-number">3</span>)
 C_TEXT($item)
 For <span class="hljs-keyword">each</span>($item;$col;<span class="hljs-number">0</span>;<span class="hljs-number">3</span>)
    $col2.push($item)
 End <span class="hljs-keyword">for</span> <span class="hljs-keyword">each</span>
  //$col2=[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-string">"a"</span>,<span class="hljs-string">"b"</span>,<span class="hljs-string">"c"</span>]
 For <span class="hljs-keyword">each</span>($item;$col;-<span class="hljs-number">2</span>;-<span class="hljs-number">1</span>)
    $col2.push($item)
 End <span class="hljs-keyword">for</span> <span class="hljs-keyword">each</span>
  //$col2=[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-string">"a"</span>,<span class="hljs-string">"b"</span>,<span class="hljs-string">"c"</span>,<span class="hljs-string">"d"</span>]
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="until-and-while-conditions"></a><a href="#until-and-while-conditions" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Until and While conditions</h3>
<p>You can control the <code>For each...End for each</code> execution by adding an <code>Until</code> or a <code>While</code> condition to the loop. When an <code>Until(condition)</code> or a <code>While(condition)</code> statement is associated to the loop, the iteration will stop as soon as the condition is evaluated to True.</p>
<p>You can pass either keyword depending on your needs:</p>
<ul>
<li>The <code>Until</code> condition is tested at the end of each iteration, so if the <em>Expression</em> is not empty or null, the loop will be executed at least once.</li>
<li>The <code>While</code> condition is tested at the beginning of each iteration, so according to the condition result, the loop may not be executed at all.</li>
</ul>
<h4><a class="anchor" aria-hidden="true" id="example-8"></a><a href="#example-8" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example</h4>
<pre><code class="hljs"> <span class="hljs-variable">$colNum</span>:=New collection(1;2;3;4;5;6;7;8;9;10)
 
 <span class="hljs-variable">$total</span>:=0
 <span class="hljs-keyword">For</span> each(<span class="hljs-variable">$num</span>;<span class="hljs-variable">$colNum</span>)<span class="hljs-keyword">While</span>(<span class="hljs-variable">$total</span>&lt;30) <span class="hljs-comment">//tested at the beginning</span>
    <span class="hljs-variable">$total</span>:=<span class="hljs-variable">$total</span>+<span class="hljs-variable">$num</span>
 End <span class="hljs-keyword">for</span> each
 ALERT(<span class="hljs-built_in">String</span>(<span class="hljs-variable">$total</span>)) <span class="hljs-comment">//$total = 36 (1+2+3+4+5+6+7+8)</span>
 
 <span class="hljs-variable">$total</span>:=1000
 <span class="hljs-keyword">For</span> each(<span class="hljs-variable">$num</span>;<span class="hljs-variable">$colNum</span>)Until(<span class="hljs-variable">$total</span>&gt;30) <span class="hljs-comment">//tested at the end</span>
    <span class="hljs-variable">$total</span>:=<span class="hljs-variable">$total</span>+<span class="hljs-variable">$num</span>
 End <span class="hljs-keyword">for</span> each
 ALERT(<span class="hljs-built_in">String</span>(<span class="hljs-variable">$total</span>)) <span class="hljs-comment">//$total = 1001 (1000+1)</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="useend-use"></a><a href="#useend-use" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Use...End use</h2>
<p>The formal syntax of the <code>Use...End use</code> structure is:</p>
<pre><code class="hljs"> Use(<span class="hljs-name">Shared_object_or_Shared_collection</span>)
    statement(<span class="hljs-name">s</span>)
 End use
</code></pre>
<p>The <code>Use...End use</code> structure defines a sequence of statements that will execute tasks on the <em>Shared_object_or_Shared_collection</em> parameter under the protection of an internal semaphore. <em>Shared_object_or_Shared_collection</em> can be any valid shared object or shared collection.</p>
<p>Shared objects and shared collections are designed to allow communication between processes, in particular, <strong>preemptive 4D processes</strong>. They can be passed by reference as parameters from a process to another one. For detailed information on shared objects or shared collections, refer to the <strong>Shared objects and shared collections</strong> page. Surrounding modifications on shared objects or shared collections by the <code>Use...End use</code> keywords is mandatory to prevent concurrent access between processes.</p>
<ul>
<li>Once the <strong>Use</strong> line is successfully executed, all <em>Shared_object_or_Shared_collection</em> properties/elements are locked for all other process in write access until the corresponding <code>End use</code> line is executed.</li>
<li>The <em>statement(s)</em> sequence can execute any modification on the Shared_object_or_Shared_collection properties/elements without risk of concurrent access.</li>
<li>If another shared object or collection is added as a property of the <em>Shared_object_or_Shared_collection</em> parameter, they become connected within the same shared group (see <strong>Using shared objects or collections</strong>).</li>
<li>If another process tries to access one of the <em>Shared_object_or_Shared_collection</em> properties or connected properties while a <strong>Use...End use</strong> sequence is being executed, it is automatically put on hold and waits until the current sequence is terminated.</li>
<li>The <strong>End use</strong> line unlocks the <em>Shared_object_or_Shared_collection</em> properties and all objects sharing the same locking identifier.</li>
<li>Several <strong>Use...End use</strong> structures can be nested in the 4D code. In that case, all locks are stacked and properties/elements will be released only when the last End use call is executed.</li>
</ul>
<p><strong>Note:</strong> If a collection method modifies a shared collection, an internal <strong>Use</strong> is automatically called for this shared collection while the function is executed.</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/doc/docs/Concepts/variables-arrays.html">← Variables and Arrays</a><a class="docs-next button" href="/doc/docs/Concepts/methods.html">Methods →</a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#ifelseend-if">If...Else...End if</a></li><li><a href="#case-ofelseend-case">Case of...Else...End case</a></li><li><a href="#whileend-while">While...End while</a></li><li><a href="#repeatuntil">Repeat...Until</a></li><li><a href="#forend-for">For...End for</a></li><li><a href="#for-eachend-for-each">For each...End for each</a><ul class="toc-headings"><li><a href="#loop-through-collections">Loop through collections</a></li><li><a href="#loop-through-entity-selections">Loop through entity selections</a></li><li><a href="#loop-through-object-properties">Loop through object properties</a></li><li><a href="#begin-end-parameters">begin / end parameters</a></li><li><a href="#until-and-while-conditions">Until and While conditions</a></li></ul></li><li><a href="#useend-use">Use...End use</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/doc/" class="nav-home"><img src="/doc/img/4dlogo.png" alt="Doc center 2018" width="66" height="58"/></a><div><h5>Docs</h5><a href="/doc/docs/en/doc1.html">Getting Started (or other categories)</a><a href="/doc/docs/en/doc2.html">Guides (or other categories)</a><a href="/doc/docs/en/doc3.html">API Reference (or other categories)</a></div><div><h5>Community</h5><a href="/doc/en/users.html">User Showcase</a><a href="http://stackoverflow.com/questions/tagged/" target="_blank" rel="noreferrer noopener">Stack Overflow</a><a href="https://discordapp.com/">Project Chat</a><a href="https://twitter.com/" target="_blank" rel="noreferrer noopener">Twitter</a></div><div><h5>More</h5><a href="/doc/blog">Blog</a><a href="https://github.com/">GitHub</a><a class="github-button" data-icon="octicon-star" data-count-href="/facebook/docusaurus/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></div></section><a href="https://code.facebook.com/projects/" target="_blank" rel="noreferrer noopener" class="fbOpenSource"><img src="/doc/img/oss_logo.png" alt="Facebook Open Source" width="170" height="45"/></a><section class="copyright">Copyright © 2018 4D SAS</section></footer></div></body></html>